!function(){function e(e,n){n=n||{bubbles:!1,cancelable:!1,detail:void 0};var t=document.createEvent("CustomEvent");return t.initCustomEvent(e,n.bubbles,n.cancelable,n.detail),t}return"function"!=typeof window.CustomEvent&&(e.prototype=window.Event.prototype,void(window.CustomEvent=e))}(),Array.from||(Array.from=function(){var e=Object.prototype.toString,n=function(n){return"function"==typeof n||"[object Function]"===e.call(n)},t=function(e){var n=Number(e);return isNaN(n)?0:0!==n&&isFinite(n)?(n>0?1:-1)*Math.floor(Math.abs(n)):n},r=Math.pow(2,53)-1,a=function(e){var n=t(e);return Math.min(Math.max(n,0),r)};return function(e){var t=this,r=Object(e);if(null==e)throw new TypeError("Array.from requires an array-like object - not null or undefined");var s,o=arguments.length>1?arguments[1]:void 0;if("undefined"!=typeof o){if(!n(o))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(s=arguments[2])}for(var i,l=a(r.length),d=n(t)?Object(new t(l)):new Array(l),u=0;u<l;)i=r[u],o?d[u]="undefined"==typeof s?o(i,u):o.call(s,i,u):d[u]=i,u+=1;return d.length=l,d}}()),function(){function dispatchEvents(){arguments.length<1&&console.error("Please provide at least one event");var e={},n=[],t=document.querySelectorAll("[data-haste-ajax-listeners]");Array.from(arguments).forEach(function(r){var a=r;"string"==typeof r&&(a={name:r});var s=!1;Array.from(t).forEach(function(n){n.dataset.hasteAjaxListeners.split(" ").indexOf(a.name)!==-1&&(s=!0,e[n.dataset.hasteAjaxId]=n)}),s&&n.push(a)}),Object.keys(e).length>0&&n.length>0&&n.forEach(function(n){sendRequest(e,n)})}function sendRequest(els,event){eventsInProgress[event.name]&&eventsInProgress[event.name].abort();for(var key in els)elementsInProgress[key]=event.name,els[key].classList.add("haste-ajax-reloading");var xhr=new XMLHttpRequest;xhr.open("GET",encodeURI(window.location.href)),xhr.setRequestHeader("X-Requested-With","XMLHttpRequest"),xhr.setRequestHeader("Haste-Ajax-Reload",event.name);for(var header in event.headers||{})xhr.setRequestHeader(header,event.headers[header]);xhr.onload=function(){if(200===xhr.status){var newEls={},entries=JSON.parse(xhr.responseText);Object.keys(entries).forEach(function(id){els[id]&&elementsInProgress[id]===event.name&&(els[id].outerHTML=entries[id],elementsInProgress[id]=null,newEls[id]=document.querySelector('[data-haste-ajax-id="'+id+'"]'),Array.from(newEls[id].getElementsByTagName("script")).forEach(function(script){eval(script.innerHTML)}))}),document.dispatchEvent(new CustomEvent("HasteAjaxReloadComplete",{bubbles:!1,cancelable:!1,detail:{entries:entries,event:event.name,eventData:event,oldElements:els,newElements:newEls}}))}else console.error('The request for event "'+event.name+'" has failed'),console.error(xhr);eventsInProgress[event.name]=null},xhr.send(),eventsInProgress[event.name]=xhr}var elementsInProgress={},eventsInProgress={};window.HasteAjaxReload={dispatchEvents:dispatchEvents}}();