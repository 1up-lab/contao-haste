window.HasteAjax={elementsInProgress:{},eventsInProgress:{},dispatchEvents:function(){arguments.length<1&&console.error("Please provide at least one event");var e={},t=[],s=document.querySelectorAll("[data-haste-ajax-listeners]");Array.from(arguments).forEach(function(n){var r=!1;Array.from(s).forEach(function(t){t.dataset.hasteAjaxListeners.split(" ").indexOf(n)!==-1&&(r=!0,e[t.dataset.hasteAjaxId]=t)}),r?t.push(n):console.warn('There are no eligible elements for event "'+n+'"')}),Object.keys(e).length>0&&t.length>0&&this._sendRequest(e,t)},_sendRequest:function(e,t){if(e=this._filterElementsInProgress(e),t=this._filterEventsInProgress(t),!(Object.keys(e).length<1||t.length<1)){this._toggleElementsInProgress(e,!0),this._toggleEventsInProgress(t,!0);for(var s in e)e[s].className+=" haste-ajax-reloading";var n=window.location.href+(document.location.search?"&":"?")+"haste_ajax_reload="+t.join(","),r=new XMLHttpRequest;r.open("GET",encodeURI(n)),r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.onload=function(){200===r.status?JSON.parse(r.responseText).forEach(function(t){var s=document.createElement("div");s.innerHTML=t.buffer,e[t.id].parentNode.replaceChild(s.childNodes[0],e[t.id])}):(console.error('The request for event "'+event+'" has failed'),console.error(r)),this._toggleElementsInProgress(e,!1),this._toggleEventsInProgress(t,!1)}.bind(this),r.send()}},_filterElementsInProgress:function(e){var t={};for(var s in e)this.elementsInProgress[s]||(t[s]=e[s]);return t},_toggleElementsInProgress:function(e,t){for(var s in e)this.elementsInProgress[s]=t},_filterEventsInProgress:function(e){return e.filter(function(e){return!this.eventsInProgress[e]}.bind(this))},_toggleEventsInProgress:function(e,t){e.forEach(function(e){this.eventsInProgress[e]=t}.bind(this))}};